 

 

 

 

 

  ASTER 

ASTER  自動販売機               

ユースケース仕様書 

テスト設計コンテスト’15 課題 

2013/06/07/(Fri)    V1.0  テスト設計コンテスト’14 課題として発行 

2014/07/11/(Fri)      V1.1  テスト設計コンテスト’15 課題として改訂 

 

Copyright© NPO 法人 ASTER 

1 

1.  はじめに 
 

 

本ドキュメントは特定非営利活動法人ソフトウェアテスト技術振興協会

（ASTER:Association of Software Test EngineeRing）(以下、NPO 法人 ASTER)が、テス

ト設計コンテストの課題として使用する目的で作られています。 

本ドキュメントの利用については以下の点についてご留意ください。 

・  このドキュメントは NPO 法人 ASTER がすべての著作権を有します。 

・  このドキュメントはテスト設計コンテストのテスト対象として使用する他、企

業・大学等の法人、またはコミュニティにおいて無料でご利用になれます。 

・  このドキュメントの全体または一部を、営利として複製、利用する場合、および、

報道を目的として公開する場合はあらかじめ NPO 法人 ASTER から承諾を受け

る必要があります。 

・  本ドキュメントの全体あるいは一部を引用される場合は、営利目的、無償の教育

目的を問わず、必ず、NPO 法人 ASTER が作成したドキュメントであることを

明記してください。また、各ページの著作権の表示（Copyright© NPO 法人

ASTER）を削除しないでください。 

・  本ドキュメントを利用したことによって生ずるいかなる損害に関しても、NPO

法人 ASTER は一切責任を負わないものとします。 

・  本ドキュメントに関するご意見、ご提言、ご感想、ご質問等がありましたら、

NPO 法人 ASTER 事務局まで E-mail にてご連絡ください。 

・  本ドキュメントは、内容の改善や適正化などの目的で予告なく改訂することがあ

ります。 

 

NPO 法人 ASTER 事務局： 

〒105-0014 

東京都港区芝 2-29-10  常和芝ビル  7F 

TEL：03-5444-7601  FAX：03-5444-8095 

E-mail： query@aster.or.jp 

 

Copyright© NPO 法人 ASTER 

2 

2.  用語集 

本書で用いる用語を記載する。 

用語 

貨幣 

金庫 

硬貨 

残高 

紙幣 

代金 

商品 

ラック 

金額表示機 

現在の残高を表示する機器のこと 

商品購入の際に機器が受け付ける紙幣と硬貨のこと 

貨幣の格納場所であり、(硬貨種別)チューブ、硬貨格納用金庫、紙幣格納用金

説明 

庫がある。 

硬貨投入口 

商品購入者が硬貨を投入する場所のこと 

日本円の 10 円, 50 円, 100 円, 500 円硬貨のこと 

機器へ投入済みの代金から、販売済み金額を減算した金額のこと 

日本円の 1,000 円札のこと 

紙幣投入口 

商品購入者が紙幣を投入する場所 

商品購入の際に機器へ投入する貨幣のこと 

「あたり」ランプ 

懸賞を実行した結果、あたった場合に点灯する機器 

懸賞ルーレット機 

懸賞を実行中に動作し、あたり、はずれを判定する機器 

「残念！はずれ」ランプ 

懸賞を実行した結果、はずれた場合に点灯する機器 

商品取り出し口 

商品購入者が購入した商品を取り出す場所のこと 

自動販売機で販売の対象となる品物のこと 

商品の保管庫のこと 

売切表示ランプ 

商品が売り切れになっている場合に点灯する機器 

準備中ランプ 

販売ボタン 

釣銭 

該当する商品がラックに存在するが、適温状態でない場合に点灯する機器 

商品購入者が商品を購入するために押下するボタン 

商品購入者へ戻す残高のうち、硬貨にて返却する貨幣のこと 

釣銭切れ表示ランプ 

自動販売機が釣銭切れの場合に点灯する機器 

釣銭取り出し口 

釣銭を排出する場所 

釣銭払出動作中表示ランプ  返金中の場合に点灯する機器 

返金 

返金ボタン 

残高を釣銭取り出し口に排出すること 

商品購入者が自動販売機に返金を要求するために押下するボタン 

 

 

 

 

 

Copyright© NPO 法人 ASTER 

3 

本章では、自動販売機利用者ユースケース（下記 5 ケース）について記載する。 

3.  ユースケース 

 

 

 

 

 

 

代金投入ユースケース 

商品選択ユースケース 

返金ユースケース 

懸賞ユースケース 

故障ユースケース 

 

3.1.  代金投入ユースケース 

本ユースケースは、アクターが貨幣（紙幣または硬貨）を投入し、自動販売

機へ投入した貨幣を受け付け完了するまでを記述する。 

代金投入ユースケースのゴールは、投入された貨幣の正当不当判定を行い、

合計金額を計算し、販売可能な商品があればそれを知らせ、合計金額を知らせ

るといった一連の処理をもって、自動販売機が代金を受け付けることである。 

3.1.1. ゴール 

3.1.2. 背景や理由 

受け付け可能な貨幣を選別し、受け付けた貨幣の合計金額とその金額で販売

可能な商品をアクターに知らせるため。 

・  受け付けられなかった貨幣によって販売できないことを投入時に伝えたい 

・  上記実現のために商品の選択より前に貨幣の正当不当を判定する 

 

Copyright© NPO 法人 ASTER 

4 

3.1.3. 事前条件 

・  初期化が異常なしで終了している 

・  故障中ではない 

・  商品送出中ではない 

・  懸賞中ではない 

・  返金中ではない 

3.1.4. 事後条件 

・  次の代金投入が可能になっている 

3.1.5. 処理（メインフロー） 

・  残高があり、残高で販売可能な商品がある場合は「販売可能な商品を通知す

・  アクターが貨幣を投入する 

  濡れた紙幣や、変形した硬貨など物理的に投入不可な貨幣以外を受け入れ

る」へ 

る 

・  次の貨幣の受け入れを中断する 

  装置の性能限界があるため（紙幣または硬貨を同時に複数処理できない） 

  貨幣受け入れ後、貨幣の正当不当判定などの一連の処理が終わるまで次

  貨幣の受け入れを中断している状態で、貨幣が投入された場合は、その

の貨幣の受け入れを中断する 

貨幣を排出する 

  貨幣受け入れ中断後、貨幣の正当不当判定などの一連の処理を終えて、

再び貨幣受け入れが可能になるまでの時間は 500 ミリ秒以内とする 

・  受け入れた貨幣の正当不当判定を行う 

  正当と判定した貨幣を受け付け、それ以外を返金する 

  受け付ける硬貨は、日本円の 10 円, 50 円, 100 円, 500 円硬貨 

  受け付ける紙幣は、日本円の 1,000 円札 

  旧硬貨、旧紙幣については受け付けない 

  投入された貨幣を不当と認識した場合は受け付けず、返金する（正当・

不当の判定は専用のハードウェアで実施する） 

  アクターが連続投入可能な貨幣の枚数の上限を超えた場合は返金をする。 

  10 円、50 円、100 円硬貨は、各 20 枚 

  500 円硬貨は 10 枚 

  1,000 円札は 1 枚 

・  受け入れた貨幣の格納枚数をチェックする 

  貨幣種別ごとに格納枚数を数え、最大格納枚数以内ならば受け付け、超え

Copyright© NPO 法人 ASTER 

5 

ていたら排出する 

・  合計金額を計算する 

計金額を計算する 

・  合計金額をアクターへ知らせる 

を表示する 

金額を表示する 

・  販売可能な商品を通知する 

  貨幣を受け付けるたびに、残高に受け付け完了の貨幣の金額を加算し、合

  紙幣または硬貨が一度も受け付けられていない場合は、金額表示機に「0」

  紙幣または硬貨が一度でも受け付けられている場合は、金額表示機に合計

  販売可能な商品の販売ボタンを点灯する 

  販売不可な商品の販売ボタンを点灯していない状態にする 

・  次の貨幣の受け入れを可能にする 

  代金を受け付け後または商品を販売（送出完了）後に 10 分経過しても代

金の追加投入または商品選択がない場合 

  返金ユースケースへ 

本ユースケースは、アクターが、点灯中の販売ボタンを押下し商品を受け取

3.2. 商品選択ユースケース 

るまでを記述する。 

3.2.1. ゴール 

商品選択ユースケースのゴールは、点灯中の販売ボタンを押下し、販売希望

された当該商品以外の販売ボタンを消灯し、当該商品の販売ボタンを点滅させ、

当該商品を 1 本、商品取り出し口に送出するといった一連の処理をもって、ア

クターが商品を受け取ることである。 

3.2.2. 背景や理由 

かを伝える。 

アクターが販売可能商品の点灯中の販売ボタンを押下した場合、当該商品を

送出し、残高を表示することで、アクターに現在の状況と次に何ができるの

・  当該商品送出中は他の商品を選択できないことをアクターに伝えたい 

・  当該商品がどれであるかをアクターに伝えたい 

・  当該商品販売後の残高をアクターに伝えたい 

・  当該商品をアクターに渡せる状態にしたい 

・  残高が販売商品の金額を下回った場合には釣銭を取り損ねることがないよ

うにしたい 

Copyright© NPO 法人 ASTER 

6 

3.2.3. 事前条件 

・  1 つ以上の販売ボタンが点灯している 

・  故障中ではない 

・  商品送出中ではない 

・  懸賞中ではない 

・  返金中ではない 

3.2.4. 事後条件 

・  当該商品の在庫が１本減っている 

・  残高で販売可能な商品がある場合は金額表示が合計金額から当該商品の金

額を引いた値になっている。 

・  残高で販売可能な商品がない場合は返金処理を行い金額表示が「0」になっ

3.2.5. 処理（メインフロー） 

ている 

る 

・  アクターが押下した販売ボタンに該当する商品を当該商品として受け付け

  懸賞ユースケースから遷移していない場合 

  「次の貨幣の受け入れを中断する」へ 

  懸賞ユースケースから遷移している場合 

  「あたり」ランプ点灯から 20 秒以内に点灯している販売ボタンを押

下した場合 

  「あたり」ランプを消灯する 

  「次の貨幣の受け入れを中断する」へ 

  「あたり」ランプ点灯から 20 秒以内に販売ボタンを押下しない場合 

  すべての販売ボタンを消灯する 

  「あたり」ランプを消灯する 

  代金の投入を可能にする 

  代金投入ユースケースへ 

・  次の貨幣の受け入れを中断する 

  装置の性能限界があるため（商品送出と貨幣受け付けを同時に処理できな

  貨幣の受け入れを中断している状態で、貨幣が投入された場合は、その貨

・  押下した販売ボタンを点滅し、それ以外の点灯している販売ボタンを消灯す

い） 

幣を排出する 

る 

  当該商品を送出中であること、連続して商品が購入できない事をアクター

Copyright© NPO 法人 ASTER 

7 

  押下したボタンを離すタイミングで点滅が始まり商品の送出を完了した時

に伝えるため 

点で点滅を止める 

・  残金を計算し、表示する 

  商品購入前の残高から当該商品の金額を減算する 

  計算結果を金額表示機に表示する 

・  商品購入後の返金処理 

  残高で販売可能な商品は一つもない場合は、返金処理を行う 

  残高で、まだ販売可能な商品がある場合は、連続購入を可能とするため返

金処理は行わない 

・  商品を送出する 

  押下された販売ボタンに関連付けられたラックから 1 つ、商品を送出する 

  販売ボタンが複数のラックに関連付けられている場合、前回の次の管

理番号のラックから商品を送出する。当該ラックが適温でない、または

当該ラックに商品がないなどの状態で商品を送出できない場合は次の管

理番号のラックから商品を送出する。初回は管理番号の一番若いラック

から送出する。 

  当該商品の管理在庫数を 1 本減らす 

・  商品送出後の処理 

  当該商品の販売ボタンを消灯する 

  懸賞ユースケースへ 

にした後、代金投入ユースケースへ 

・  商品が詰まった場合の振る舞い 

  懸賞があたってこのユースケースへ来た場合は貨幣の受け入れを可能

  商品取り出し口センサが、商品が 1 分間詰まっていることを検知した場合 

  故障ユースケースへ 

本ユースケースは、アクターが投入した貨幣の残金を入手するための残高の返金処

3.3. 返金ユースケース 

理について記述する。 

3.3.1. ゴール 

返金ユースケースのゴールは、投入の受け入れを中断し、商品の販売ボタン

を消灯し、釣銭払出動作中表示ランプを点滅し、貨幣の優先順位で残高を減算

するとともに返金し、残高が 0 になったところで、釣銭払出動作中表示ランプ

を消灯するといった一連の処理をもって、アクターが自動販売機に投入した貨

Copyright© NPO 法人 ASTER 

8 

幣の残金を入手することである。 

3.3.2. 背景や理由 

とする。 

アクターが投入した代金にて商品を購入しないときに、投入済みの代金をア

クターに返すため。また、アクターの便宜を考慮し、可能な限り最少枚数の釣銭

・  紙幣については、偽札のリスクを考慮し、受け入れた現物を返金する 

・  1,000 円札を受け入れていない状況で残高が 1,000 円を超えていた場合は、

硬貨で返金する。これは、硬貨を投入して紙幣が返ってくると気が付かない

アクターが出るのではないかとの配慮と、紙幣の搬送詰まりによる返金不可

・  そのときに、チューブに入っている硬貨を使ってアクターに渡る硬貨が最少

を防止するため 

の枚数になるように返金する 

3.3.3. 事前条件 

・  残高が 0 円でない 

・  商品送出中ではない 

・  懸賞中ではない 

3.3.4. 事後条件 

・  残高が 0 円になっている 

・  釣銭払出動作中表示ランプが消灯している 

・  販売ボタンが消灯している 

3.3.5. 処理（メインフロー） 

・  返金処理の開始契機 

  アクターが返金ボタンを押下した場合 

  アクターが代金投入後、10 分経過しても代金の追加投入がなく、かつ、商

品選択もない場合 

  アクターが商品購入後、購入可能な残高が残った状態になってから 10 分

経過しても代金の追加投入がなく、かつ、商品選択もない場合 

  アクターが商品購入後、残高が販売可能な商品の金額を下回った場合 

・  返金前処理 

  代金投入の受け付けを中断する 

  販売ボタンを消灯する 

  釣銭払出動作中表示ランプを点滅する 

  釣銭払出動作中表示ランプの点滅は、返金完了まで続く 

Copyright© NPO 法人 ASTER 

9 

・  返金処理 

  紙幣、硬貨の優先順位で残高を減算するとともに返金する 

  1,000 円札が投入されている状態であればそれを返金する 

  紙幣の返金処理後は、排出硬貨の枚数が最少になるように、金額の大

きく、かつチューブに存在する硬貨順に一枚ずつ釣銭取り出し口に排出

する 

  排出した貨幣の額を逐次残高から減算し、残高を更新表示する 

  残高が 0 になるまで硬貨排出・残高更新表示を繰り返す 

  釣銭払出動作中表示ランプを消灯する 

  代金投入ユースケースへ 

本ユースケースは、懸賞の実行から懸賞結果の提示までを記述する。 

3.4. 懸賞ユースケース 

3.4.1. ゴール 

懸賞ユースケースのゴールは、懸賞対象商品の選択と送出が完了したときに

懸賞ルーレットを開始し、「あたり」もしくは「はずれ」のランプを点灯させる

といった一連の処理をもってアクターに懸賞の結果を知らせることである。 

3.4.2. 背景や理由 

の自動販売機との差別化）。 

アクターが再びこの自動販売機を選んでくれるようになってもらいたい（他

・  懸賞機能がある自動販売機と、ない自動販売機であれば、同じ商品を同額で

購入できるのなら懸賞機能がある自動販売機の方がアクターに選択されや

・  懸賞対象の商品が選択され取り出し口への送出後の処理が完了している 

・  懸賞あたり対象となる販売可能な商品が少なくとも一本ある 

すい 

3.4.3. 事前条件 

・  故障中ではない 

・  商品送出中ではない 

・  返金中ではない 

3.4.4. 事後条件 

・  あたりの場合は、商品選択が可能な状態になっている 

・  はずれの場合は、次の代金投入が可能な状態になっている 

Copyright© NPO 法人 ASTER 

10 

3.4.5. 処理（メインフロー） 

・  懸賞ルーレットの処理 

  懸賞対象の商品の送出処理が完了したときにルーレットを開始する 

  懸賞対象の商品とは以下のもの全てを指す。 

  販売管理者によって懸賞対象と設定された商品 

  投入した代金で購入した商品 

(懸賞であたりになって選択した商品は懸賞対象とならない) 

  懸賞ルーレットの周りにあるランプの 1 つをあたり位置として点滅さ

せる 

  前回最後に点灯していたランプからルーレットを開始する 

  初期値は 3 時の方向のランプを点灯する 

  ルーレットを 5 秒間回す 

  順次右回りの方向にランプの消灯、点灯を行う 

  ルーレットのランプが回っている間、音を流す 

  ルーレットを止めて、懸賞結果をアクターに示す 

  ルーレット停止時、ルーレットのランプは消灯しない 

  回っていたランプの停止位置が、あたり位置として点滅していたラン

プと同じ位置であった場合をあたり、それ以外のランプで停止した場合

をはずれとする 

  あたりの場合：  「あたり」のランプを 20 秒、20 秒以内にアクターが

商品選択をするまで点灯する 

  はずれの場合：  「残念！はずれ」のランプを点灯する 

・  懸賞あたりの処理 

  懸賞あたり対象商品の販売ボタンを点灯する 

  商品選択ユースケースへ 

・  懸賞はずれの処理 

  5 秒後「残念！はずれ」ランプを消灯する 

  代金投入ユースケースへ 

3.5. 故障ユースケース 

本ユースケースは、販売動作中の故障処理について記述する。 

3.5.1. ゴール 

故障ユースケースのゴールは故障を検出した場合、動作を中断し、返金し、

自動販売機を停止することである。 

Copyright© NPO 法人 ASTER 

11 

3.5.2. 背景や理由 

ハードウェアで何らかの故障が生じた場合、それをアクターに知らせ、代金

などはアクターに損のない形で返金したいため。 

3.5.3. 事前条件 

・  電源を ON にしている 

3.5.4. 事後条件 

・  自動販売機が停止状態になっている 

3.5.5. 処理（メインフロー） 

・  故障の定義 

故障とは、自動販売機が以下の現象になることを指す。 

  商品が送出途中で 1 分間以上詰まった状態である 

  電源 ON 後、または販売者用機能によりラック内温度を設定後、1 時間以

上経過してもラック内温度が適温の範囲内に達しない 

  全てのラックの商品在庫数が 0 本になる 

  その他のハードウェア故障 

・  故障を検出したときの処理 

  すべての販売ボタン内の「売切表示ランプ」を点灯する 

  自動販売機は代金投入の受け入れを停止する 

  商品送出前である場合は、商品が詰まったことに起因する故障を除き、

商品を送出する 

  残金がある場合は返金する 

  上記の処理が完了したら売切表示ランプ点灯以外の機能を停止する 

  故障の原因を取り除き、販売者用の内部キーボードで復帰を指示した場

合に故障状態から復帰する 

Copyright© NPO 法人 ASTER 

12 

4.  状態遷移図 

4.1.  自動販売機全体 

4.2. 自動販売機（正常動作、販売可能） 

Copyright© NPO 法人 ASTER 

13 

 

 

4.3. 販売ボタン 

 

5.  謝辞 

本テストベースを作成するにあたり、下記論文を参考にさせていただきまし

た。 

 

 

鯵坂 恒夫，池田 健次郎，中谷 多哉子，野呂昌満（1997）：“OO'97 オブジェ

クト指向モデリングワークショップ報告”，情報処理学会研究報告. ソフトウ

ェア工学研究会報告  97(84), 33-43, 1997-09-11 

また、あわせて、中谷 多哉子先生から「自動販売機シーケンス図によるモ

デルの検証」および「自動販売機分析結果の例」を提供していただき、こちら

も参考にさせていただきました。ありがとうございました。 

 

 

Copyright© NPO 法人 ASTER 

14 

